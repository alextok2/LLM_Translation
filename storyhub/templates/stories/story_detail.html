{% extends "base.html" %}
{% block title %}{{ story.title }}{% endblock %}
{% block content %}
<h1 class="text-2xl font-bold mb-2">{{ story.title }}</h1>
<p class="text-gray-700 mb-4">{{ story.description }}</p>

{% if chapters %}
  {% for ch in chapters %}
    <h2 class="text-xl font-semibold mt-6 mb-3">{{ ch.title|default:"Глава " }}{% if not ch.title %}{{ ch.index }}{% endif %}</h2>
    {% for item in ch.items %}
      <div class="mb-6">
        <p class="whitespace-pre-line">{{ item.text }}</p>
        <div class="mt-2 grid grid-cols-5 gap-2">
          {% for ill in item.illustrations %}
            <img src="{{ ill.image_url }}" class="w-full h-24 object-cover rounded border {{ ill.is_selected|yesno:'ring-2 ring-blue-500,' }}">
          {% endfor %}
        </div>
      </div>
    {% endfor %}
  {% endfor %}
{% else %}
  {# Фоллбек для историй без глав #}
  {% for item in content %}
    <div class="mb-6">
      <p class="whitespace-pre-line">{{ item.text }}</p>
      <div class="mt-2 grid grid-cols-5 gap-2">
        {% for ill in item.illustrations %}
          <img src="{{ ill.image_url }}" class="w-full h-24 object-cover rounded border {{ ill.is_selected|yesno:'ring-2 ring-blue-500,' }}">
        {% endfor %}
      </div>
    </div>
  {% endfor %}
{% endif %}
{% endblock %}