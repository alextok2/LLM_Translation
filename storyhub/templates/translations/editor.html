{% extends "base.html" %}
{% block title %}Редактор: {{ story.title }}{% endblock %}
{% block content %}
<h1 class="text-2xl font-bold mb-2">{{ story.title }}</h1>
<p class="text-gray-700 mb-2">{{ story.description }}</p>
<div class="text-sm text-gray-600 mb-4">
  Прогресс: {{ story.translated_count }}/{{ story.paragraphs_count }}
</div>

{% if chapters %}
  {% for ch in chapters %}
    <h2 class="text-lg font-semibold mt-6 mb-3">Глава {{ ch.index }}{% if ch.title %}: {{ ch.title }}{% endif %}</h2>
    <div class="space-y-6">
      {% for p in ch.paragraphs %}
        {% include "translations/_paragraph_row.html" with p=p %}
      {% endfor %}
    </div>
  {% endfor %}
{% else %}
  <div class="space-y-6">
    {% for p in paragraphs %}
      {% include "translations/_paragraph_row.html" with p=p %}
    {% endfor %}
  </div>
{% endif %}

{% if story.translated_count == story.paragraphs_count and story.paragraphs_count > 0 %}
<form hx-post="/api/stories/{{ story.id }}/complete/" hx-swap="none" class="mt-6">
  {% csrf_token %}
  <button class="bg-purple-600 text-white px-4 py-2 rounded">Отметить историю как готовую</button>
</form>
{% endif %}
{% endblock %}